<!DOCTYPE html>
<html lang="en" ng-app="gymBuddy">
<head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="http://faviconist.com/icons/9dc89a32b7834bb6d52bc9588d575a43/favicon.ico" />
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/leaflet.awesome-markers.css">
    <link rel="stylesheet" href="css/buddy.css">

    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.min.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="js/angular-leaflet-directive.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <style type="text/css">
    #map {
        width: 700px;
        height: 550px;
    }
    </style>
    <title>GymBuddy</title>
    <script>
      var app = angular.module('gymBuddy', ['leaflet-directive']);


    </script>
</head>
<body>
    <div id="nav-bar">
      <div id="nav-title">
        GYMBUDDY
      </div>
    </div>
    <div id="left-side">
      <div id="map"></div>

      <script type="text/javascript">

      var mapboxTiles = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            maxZoom: 18,
            id: 'jahde.mmllmcng',
            accessToken: 'pk.eyJ1IjoiamFoZGUiLCJhIjoiNjk4ZGYyZGJkNWNjY2I1MzM4MTVlYmUxNmNiZTkzYzYifQ.stPmhXbpMlB7zX9v5KzFEA'
      });

      var map = L.map('map')
          .addLayer(mapboxTiles)
          .setView([40.736, -74.015], 13);

      // jQuery to grab the businesses JSON
      var promise = $.getJSON("businesses.json");
      promise.then(function(data) {

        var allbusinesses = L.geoJson(data);
        // allbusinesses.addTo(map);

        function onEachFeature(feature, layer) {
          // check feature for popupContent property then display
          if (feature.properties && feature.properties.popupContent) {
            layer.bindPopup(feature.properties.popupContent);
          }
        }

        L.geoJson(data, {
          onEachFeature: onEachFeature,
          pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {

            }).on('mouseover', function() {
              this.bindPopup(feature.properties.Name).openPopup();
            });
          }
        }).addTo(map);

        map.fitBounds(allbusinesses.getBounds(), {
          padding: [50, 50]
        })

        // console.log(data)
      })

      </script>
    </div>
    <div id="right-side">
      <div class="row">
        <table ng-cloak class='table table-striped full'>
          <thead>
            <tr>
              <th>
              </th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
</body>
</html>
